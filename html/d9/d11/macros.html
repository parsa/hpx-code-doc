<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HPX: Macros - how, what for?</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HPX
   </div>
   <div id="projectbrief">High Performance ParalleX</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Macros - how, what for? </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li><a class="el" href="../../d9/d11/macros.html#macros_if_else_strategy">The if-else strategy</a></li>
<li><a class="el" href="../../d9/d11/macros.html#macros_using">Using the macros supplied with the library</a><ul>
<li><a class="el" href="../../d9/d11/macros.html#macros_define_declare">Macros to declare/define logs/filters</a><ul>
<li><a class="el" href="../../d9/d11/macros.html#HPX_DECLARE_LOG">HPX_DECLARE_LOG - declaring a log</a></li>
<li><a class="el" href="../../d9/d11/macros.html#HPX_DEFINE_LOG">HPX_DEFINE_LOG - defining a log</a></li>
<li><a class="el" href="../../d9/d11/macros.html#HPX_DEFINE_LOG_WITH_ARGS">HPX_DEFINE_LOG_WITH_ARGS</a></li>
<li><a class="el" href="../../d9/d11/macros.html#HPX_DECLARE_LOG_FILTER">HPX_DECLARE_LOG_FILTER - declaring a log filter</a></li>
<li><a class="el" href="../../d9/d11/macros.html#HPX_DEFINE_LOG_FILTER">HPX_DEFINE_LOG_FILTER - defining a log filter</a></li>
<li><a class="el" href="../../d9/d11/macros.html#HPX_DEFINE_LOG_FILTER_WITH_ARGS">HPX_DEFINE_LOG_FILTER_WITH_ARGS</a></li>
</ul>
</li>
<li><a class="el" href="../../d9/d11/macros.html#macros_use">Macros that help you define your own macros for logging</a><ul>
<li><a class="el" href="../../d9/d11/macros.html#HPX_LOG_USE_LOG">HPX_LOG_USE_LOG</a></li>
<li><a class="el" href="../../d9/d11/macros.html#HPX_LOG_USE_LOG_IF_LEVEL">HPX_LOG_USE_LOG_IF_LEVEL</a></li>
<li><a class="el" href="../../d9/d11/macros.html#HPX_LOG_USE_LOG_IF_FILTER">HPX_LOG_USE_LOG_IF_FILTER</a></li>
<li><a class="el" href="../../d9/d11/macros.html#HPX_LOG_USE_SIMPLE_LOG_IF_FILTER">HPX_LOG_USE_SIMPLE_LOG_IF_FILTER</a></li>
</ul>
</li>
<li><a class="el" href="../../d9/d11/macros.html#macros_set_formatters">Setting formatter/destination strings</a><ul>
<li><a class="el" href="../../d9/d11/macros.html#HPX_LOG_FORMAT_MSG">HPX_LOG_FORMAT_MSG</a></li>
<li><a class="el" href="../../d9/d11/macros.html#HPX_LOG_DESTINATION_MSG">HPX_LOG_DESTINATION_MSG</a></li>
</ul>
</li>
<li><a class="el" href="../../d9/d11/macros.html#macros_use_tags">Using tags</a><ul>
<li><a class="el" href="../../d9/d11/macros.html#HPX_LOG_TAG">HPX_LOG_TAG</a></li>
<li><a class="el" href="../../d9/d11/macros.html#HPX_LOG_TAG_LEVEL">HPX_LOG_TAG_LEVEL</a></li>
<li><a class="el" href="../../d9/d11/macros.html#HPX_LOG_TAG_FILELINE">HPX_LOG_TAG_FILELINE</a></li>
<li><a class="el" href="../../d9/d11/macros.html#HPX_LOG_TAG_FUNCTION">HPX_LOG_TAG_FUNCTION</a></li>
</ul>
</li>
<li><a class="el" href="../../d9/d11/macros.html#macros_compile_time">Macros that treat compilation time</a><ul>
<li><a class="el" href="../../d9/d11/macros.html#macros_compile_time_fast">Fast Compilation time</a></li>
<li><a class="el" href="../../d9/d11/macros.html#macros_compile_time_slow">Slow Compilation time</a></li>
<li><a class="el" href="../../d9/d11/macros.html#HPX_LOG_compile_results">Compile time sample (and results)</a></li>
</ul>
</li>
<li><a class="el" href="../../d9/d11/macros.html#macros_tss">Macros that deal with Thread Specific Storage</a><ul>
<li><a class="el" href="../../d9/d11/macros.html#HPX_LOG_TSS_USE_INTERNAL">HPX_LOG_TSS_USE_INTERNAL</a></li>
<li><a class="el" href="../../d9/d11/macros.html#HPX_LOG_TSS_USE_BOOST">HPX_LOG_TSS_USE_BOOST</a></li>
<li><a class="el" href="../../d9/d11/macros.html#HPX_LOG_TSS_USE_CUSTOM">HPX_LOG_TSS_USE_CUSTOM</a></li>
<li><a class="el" href="../../d9/d11/macros.html#HPX_HAVE_LOG_NO_TSS">HPX_HAVE_LOG_NO_TSS</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Simply put, you need to use macros to make sure objects (logger(s) and filter(s)) :</p><ul>
<li>are created before main</li>
<li>are always created before being used</li>
</ul>
<p>The problem we want to avoid is using a logger object before it's initialized</p><ul>
<li>this could happen if logging from the constructor of a global/static object.</li>
</ul>
<p>Using macros makes sure logging happens efficiently. Basically what you want to achieve is something similar to:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> ( is_filter_enabled)</div><div class="line">    <a class="code" href="../../db/dc5/namespacehpx_1_1components_1_1detail.html#aa61439b17da33d0b084ae376b5ba08fd">logger</a>.gather_the_message_and_log_it();</div></div><!-- fragment --><h1><a class="anchor" id="macros_if_else_strategy"></a>
The if-else strategy</h1>
<p>When gathering the message, what the macros will achieve is this:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define YOUR_COOL_MACRO_GOOD if ( !is_filter_enabled) \</span></div><div class="line"><span class="preprocessor">; else logger.gather_the_message_and_log_it();</span></div></div><!-- fragment --><p>The above is the correct way, instead of</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define YOUR_COOL_MACRO_BAD if ( is_filter_enabled) \</span></div><div class="line"><span class="preprocessor">logger.gather_the_message_and_log_it();</span></div></div><!-- fragment --><p>because of</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> ( some_test)</div><div class="line">  YOUR_COOL_MACRO_BAD &lt;&lt; <span class="stringliteral">&quot;some message &quot;</span>;</div><div class="line"><span class="keywordflow">else</span></div><div class="line">  whatever();</div></div><!-- fragment --><p>In this case, <code>whatever()</code> will be called if <code>some_test</code> is true, and if <code>is_filter_enabled</code> is false.</p>
<p><br />
<br />
 </p>
<h1><a class="anchor" id="macros_using"></a>
Using the macros supplied with the library</h1>
<p>There are several types of macros that this library supplies. They're explained below:</p>
<h2><a class="anchor" id="macros_define_declare"></a>
Macros to declare/define logs/filters</h2>
<h3><a class="anchor" id="HPX_DECLARE_LOG"></a>
HPX_DECLARE_LOG - declaring a log</h3>
<div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#a4e5c1ad63154b472bd365a390665cdc0">HPX_DECLARE_LOG</a>(log_name, logger_type)</div></div><!-- fragment --><p>This declares a log. It should be used in a header file, to declare the log. Note that <code>logger_type</code> only needs to be a declaration (a <code>typedef</code>, for instance)</p>
<p>Example: </p><div class="fragment"><div class="line"><span class="keyword">typedef</span> logger_format_write&lt; &gt; logger_type;</div><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#a4e5c1ad63154b472bd365a390665cdc0">HPX_DECLARE_LOG</a>(g_l, logger_type)</div></div><!-- fragment --><h3><a class="anchor" id="HPX_DEFINE_LOG"></a>
HPX_DEFINE_LOG - defining a log</h3>
<div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#a26d9fb16d94dd8a329631b93bd864417">HPX_DEFINE_LOG</a>(log_name, logger_type)</div></div><!-- fragment --><p>This defines a log. It should be used in a source file, to define the log.</p>
<p>Example: </p><div class="fragment"><div class="line"><span class="keyword">typedef</span> logger_format_write&lt; &gt; logger_type;</div><div class="line">...</div><div class="line">HPX_DEFINE_LOG(g_l, logger_type)</div></div><!-- fragment --><h3><a class="anchor" id="HPX_DEFINE_LOG_WITH_ARGS"></a>
HPX_DEFINE_LOG_WITH_ARGS</h3>
<ul>
<li>defining a log with arguments</li>
</ul>
<div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#afebdd7f22ce1c2f44f415f5681c6fe00">HPX_DEFINE_LOG_WITH_ARGS</a> (log_name, logger_type, <a class="code" href="../../d1/d61/namespacehpx__optsweep.html#a818a9e2aa49e5919c240526969eb1b9f">args</a>)</div></div><!-- fragment --><p>This defines a log - and specifies some arguments to be used at its constructed. It should be used in a source file, to define the log.</p>
<p>Example: </p><div class="fragment"><div class="line"><span class="keyword">typedef</span> logger&lt; default_, destination::file&gt; err_log_type;</div><div class="line">...</div><div class="line">HPX_DEFINE_LOG_WITH_ARGS( g_log_err(), err_log_type, (<span class="stringliteral">&quot;err.txt&quot;</span>) )</div></div><!-- fragment --><h3><a class="anchor" id="HPX_DECLARE_LOG_FILTER"></a>
HPX_DECLARE_LOG_FILTER - declaring a log filter</h3>
<div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#ad0bd8fe668b4b23515c5848ae92a214e">HPX_DECLARE_LOG_FILTER</a>(filter_name, <a class="code" href="../../df/da0/namespacehpx_1_1util_1_1logging.html#a500de04165a532417f61a6a3fa8977c8">filter_type</a>)</div></div><!-- fragment --><p>This declares a log filter. It should be used in a header file, to declare the log filter.</p>
<p>Example: </p><div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#ad0bd8fe668b4b23515c5848ae92a214e">HPX_DECLARE_LOG_FILTER</a>(g_log_filter, filter::no_ts )</div></div><!-- fragment --><h3><a class="anchor" id="HPX_DEFINE_LOG_FILTER"></a>
HPX_DEFINE_LOG_FILTER - defining a log filter</h3>
<div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#aad83f2bebe289b39f3fd71cf15ec913a">HPX_DEFINE_LOG_FILTER</a>(filter_name, <a class="code" href="../../df/da0/namespacehpx_1_1util_1_1logging.html#a500de04165a532417f61a6a3fa8977c8">filter_type</a>)</div></div><!-- fragment --><p>This defines a log filter. It should be used in a source file, to define the log filter.</p>
<p>Example: </p><div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#aad83f2bebe289b39f3fd71cf15ec913a">HPX_DEFINE_LOG_FILTER</a>(g_log_filter, filter::no_ts )</div></div><!-- fragment --><h3><a class="anchor" id="HPX_DEFINE_LOG_FILTER_WITH_ARGS"></a>
HPX_DEFINE_LOG_FILTER_WITH_ARGS</h3>
<ul>
<li>defining a log filter with args</li>
</ul>
<div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#a1b5aa66b756051a10e4e25a06ab0ac0c">HPX_DEFINE_LOG_FILTER_WITH_ARGS</a>(filter_name, <a class="code" href="../../df/da0/namespacehpx_1_1util_1_1logging.html#a500de04165a532417f61a6a3fa8977c8">filter_type</a>, <a class="code" href="../../d1/d61/namespacehpx__optsweep.html#a818a9e2aa49e5919c240526969eb1b9f">args</a>)</div></div><!-- fragment --><p>This defines a log filter - and specifies some arguments to be used at its constructed. It should be used in a source file, to define the log filter.</p>
<p>Example: </p><div class="fragment"><div class="line"><span class="preprocessor">#define L_ HPX_DEFINE_LOG_FILTER(g_log_filter, filter::no_ts )</span></div></div><!-- fragment --><h2><a class="anchor" id="macros_use"></a>
Macros that help you define your own macros for logging</h2>
<h3><a class="anchor" id="HPX_LOG_USE_LOG_IF_LEVEL"></a>
HPX_LOG_USE_LOG_IF_LEVEL</h3>
<p>Uses a logger if a filter has a certain level enabled:</p>
<div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#aef17ccffe6ef53e20f938b2e0dfc6e67">HPX_LOG_USE_LOG_IF_LEVEL</a>(<a class="code" href="../../d8/ddc/namespacehpx__run__test.html#a8953e35d308c499ea1968488d26af72c">log</a>, level_filter, <a class="code" href="../../d3/d60/namespacehpx_1_1util_1_1logging_1_1scenario_1_1usage_1_1filter___1_1level.html">level</a> )</div></div><!-- fragment --><p>Example: </p><div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#ad0bd8fe668b4b23515c5848ae92a214e">HPX_DECLARE_LOG_FILTER</a>(g_log_level, <a class="code" href="../../d0/d43/namespacehpx_1_1util_1_1logging_1_1level.html#ad55265d658ea02b39b64bd5004143192">hpx::util::logging::level::holder</a> )</div><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#a4e5c1ad63154b472bd365a390665cdc0">HPX_DECLARE_LOG</a>(g_log_err, logger_type)</div><div class="line"></div><div class="line"><span class="preprocessor">#define LERR_ HPX_LOG_USE_LOG_IF_LEVEL(g_log_err(), g_log_level(), error )</span></div></div><!-- fragment --><p>See defining_logger_macros for more details</p>
<h3><a class="anchor" id="HPX_LOG_USE_LOG_IF_FILTER"></a>
HPX_LOG_USE_LOG_IF_FILTER</h3>
<p>Uses a logger if a filter is enabled:</p>
<div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#aa0cb36d29de72f2f076dc8fcae7c3948">HPX_LOG_USE_LOG_IF_FILTER</a>(<a class="code" href="../../d8/ddc/namespacehpx__run__test.html#a8953e35d308c499ea1968488d26af72c">log</a>, filter_is_enabled)</div></div><!-- fragment --><p>Example: </p><div class="fragment"><div class="line"><span class="preprocessor">#define LERR_ HPX_LOG_USE_LOG_IF_FILTER(g_log_err(), g_log_filter()-&gt;is_enabled() )</span></div></div><!-- fragment --><p>See defining_logger_macros for more details</p>
<h3><a class="anchor" id="HPX_LOG_USE_LOG"></a>
HPX_LOG_USE_LOG</h3>
<p>Uses a logger:</p>
<div class="fragment"><div class="line"><a class="code" href="../../d8/d28/cache__before__init__macros_8hpp.html#a734e93bb19666dd00d8fe5521238cea3">HPX_LOG_USE_LOG</a>(l, do_func, is_log_enabled)</div></div><!-- fragment --><p>Normally you don't use this directly. You use <a class="el" href="../../d9/d11/macros.html#HPX_LOG_USE_LOG_IF_FILTER">HPX_LOG_USE_LOG_IF_FILTER</a> or <a class="el" href="../../d9/d11/macros.html#HPX_LOG_USE_LOG_IF_LEVEL">HPX_LOG_USE_LOG_IF_LEVEL</a> instead.</p>
<p>See defining_logger_macros for more details</p>
<h3><a class="anchor" id="HPX_LOG_USE_SIMPLE_LOG_IF_FILTER"></a>
HPX_LOG_USE_SIMPLE_LOG_IF_FILTER</h3>
<p>Uses a simple logger:</p>
<div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#ab59fad758c6b727cd42577aacdd4a3e4">HPX_LOG_USE_SIMPLE_LOG_IF_FILTER</a>(l, is_log_enabled)</div></div><!-- fragment --><p><a class="el" href="../../d7/da0/struct_a.html">A</a> simple logger is one that uses a simple gather class (FIXME). Example:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>no_gather {</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> * m_msg;</div><div class="line">    no_gather() : m_msg(0) {}</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="../../dd/dde/reduce__by__key_8cpp.html#a84232f9d16ffc27ce82772d011761d23">msg</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_msg; }</div><div class="line">    <span class="keywordtype">void</span> <a class="code" href="../../d5/d69/wait__all__hang__1946_8cpp.html#ae95890c5079ed07d292e9e2c1b187e97">out</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="../../dd/dde/reduce__by__key_8cpp.html#a84232f9d16ffc27ce82772d011761d23">msg</a>) { m_msg = <a class="code" href="../../dd/dde/reduce__by__key_8cpp.html#a84232f9d16ffc27ce82772d011761d23">msg</a>; }</div><div class="line">    <span class="keywordtype">void</span> <a class="code" href="../../d5/d69/wait__all__hang__1946_8cpp.html#ae95890c5079ed07d292e9e2c1b187e97">out</a>(<span class="keyword">const</span> std::string&amp; <a class="code" href="../../dd/dde/reduce__by__key_8cpp.html#a84232f9d16ffc27ce82772d011761d23">msg</a>) { m_msg = msg.c_str(); }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> logger&lt; no_gather, destination::cout &gt; app_log_type;</div><div class="line"></div><div class="line"><span class="preprocessor">#define LAPP_ HPX_LOG_USE_SIMPLE_LOG_IF_FILTER(g_log_app(),</span></div><div class="line"><span class="preprocessor">g_log_filter()-&gt;is_enabled() )</span></div></div><!-- fragment --><p>See defining_logger_macros for more details</p>
<p><br />
<br />
</p>
<h2><a class="anchor" id="macros_set_formatters"></a>
Setting formatter/destination strings</h2>
<h3><a class="anchor" id="HPX_LOG_FORMAT_MSG"></a>
HPX_LOG_FORMAT_MSG</h3>
<p>Sets the string class used by the formatter classes. By default, it's <code>std::(w)string</code></p>
<div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#a1e29dfd82ff1d0585c0a89ca1b61c843">HPX_LOG_FORMAT_MSG</a>( string_class )</div></div><!-- fragment --><p>You can do this to optimize formatting the message</p><ul>
<li>that is, use a string class optimized for appending and prepending messages (which is basically what formatting is all about).</li>
</ul>
<p>Example: </p><div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#a1e29dfd82ff1d0585c0a89ca1b61c843">HPX_LOG_FORMAT_MSG</a>( optimize::cache_string_one_str&lt;&gt; )</div></div><!-- fragment --><h3><a class="anchor" id="HPX_LOG_DESTINATION_MSG"></a>
HPX_LOG_DESTINATION_MSG</h3>
<p>Sets the string class used by the destination classes. By default, it's <code>std::(w)string</code></p>
<div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#a5791a0f4e6d86808642fb7bd5b22704f">HPX_LOG_DESTINATION_MSG</a>( string_class )</div></div><!-- fragment --><p>Example: </p><div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#a5791a0f4e6d86808642fb7bd5b22704f">HPX_LOG_DESTINATION_MSG</a>( std::string )</div></div><!-- fragment --><p>Usually you won't need to change this. The destination classes don't change the contets of the string</p><ul>
<li>each class just writes the string to a given destination.</li>
</ul>
<p><br />
<br />
 </p>
<h2><a class="anchor" id="macros_use_tags"></a>
Using tags</h2>
<p>Note that tags are only used when you create your own macros for logging. See the tag namespace.</p>
<h3><a class="anchor" id="HPX_LOG_TAG"></a>
HPX_LOG_TAG</h3>
<div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#a784b57f776ed7740eaa57aec1a2699a6">HPX_LOG_TAG</a>(tag_class)</div></div><!-- fragment --><p>Adds a tag from the <a class="el" href="../../d6/d9a/namespacehpx_1_1util_1_1logging_1_1tag.html" title="Allows you to use tags (extra information about the context of the logged message: file/line...">hpx::util::logging::tag</a> namespace. In other words, this is a shortcut for <code> hpx::util::logging::tag::tag_class</code>. Note that in case the <code>tag_class</code> has a custom constructor, you need to pass the params as well, after the macro, like shown below.</p>
<p>Example:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define L_(module_name) HPX_LOG_USE_LOG_IF_FILTER(g_l(), \</span></div><div class="line"><span class="preprocessor">g_log_filter()-&gt;is_enabled() ) .set_tag( HPX_LOG_TAG(module)(module_name) )</span></div></div><!-- fragment --><h3><a class="anchor" id="HPX_LOG_TAG_LEVEL"></a>
HPX_LOG_TAG_LEVEL</h3>
<p>Adds a level tag.</p>
<div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#a784b57f776ed7740eaa57aec1a2699a6">HPX_LOG_TAG</a>(tag_level)</div></div><!-- fragment --><p>Example:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define LDBG_ HPX_LOG_USE_LOG_IF_LEVEL(g_log_dbg(), g_log_level(), debug ) \</span></div><div class="line"><span class="preprocessor">.set_tag( HPX_LOG_TAG_LEVEL(debug) )</span></div><div class="line"><span class="preprocessor">#define LERR_ HPX_LOG_USE_LOG_IF_LEVEL(g_log_dbg(), g_log_level(), error ) \</span></div><div class="line"><span class="preprocessor">.set_tag( HPX_LOG_TAG_LEVEL(error) )</span></div></div><!-- fragment --><h3><a class="anchor" id="HPX_LOG_TAG_FILELINE"></a>
HPX_LOG_TAG_FILELINE</h3>
<p>Ads the file/line tag (that is, the current <code><b>FILE</b></code> and <code><b>LINE</b></code> will be appended, for each logged message).</p>
<div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#aceaf31a523d775fda32ddb615438e709">HPX_LOG_TAG_FILELINE</a></div></div><!-- fragment --><p>Example:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define L_ HPX_LOG_USE_LOG_IF_FILTER(g_l(), g_log_filter()-&gt;is_enabled() \</span></div><div class="line"><span class="preprocessor">) .set_tag( HPX_LOG_TAG_FILELINE)</span></div></div><!-- fragment --><h3><a class="anchor" id="HPX_LOG_TAG_FUNCTION"></a>
HPX_LOG_TAG_FUNCTION</h3>
<p>Ads the function tag (that is, the <code>BOOST_CURRENT_FUNCTION</code> will be appended, for each logged message).</p>
<div class="fragment"><div class="line"><a class="code" href="../../db/dbe/macros_8hpp.html#abbf2b7b2f89951688cab10b29aa99161">HPX_LOG_TAG_FUNCTION</a></div></div><!-- fragment --><p>Example:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define L_ HPX_LOG_USE_LOG_IF_FILTER(g_l(), g_log_filter()-&gt;is_enabled() ) /</span></div><div class="line"><span class="preprocessor">.set_tag( HPX_LOG_TAG_FUNCTION)</span></div></div><!-- fragment --><p><br />
<br />
 </p>
<h2><a class="anchor" id="macros_compile_time"></a>
Macros that treat compilation time</h2>
<p>Assume you're using formatters and destinations, and you <code>#include &lt;<a class="el" href="../../d4/d0a/format_8hpp.html">hpx/util/logging/format.hpp</a>&gt; </code> in every source file when you want to do logging. This will increase compilation time quite a bit (30 to 50%, in my tests; depending on your application' complexity, this could go higher).</p>
<p>Thus, you can choose to:</p><ol type="1">
<li>have fast compilation time, and a virtual function call per each logged message (default on debug mode)</li>
<li>have everything inline (no virtual function calls), very fast, and slower compilation (default on release mode)</li>
</ol>
<p>In the former case, most of the time you won't notice the extra virtual function call, and the compilation time will be faster.</p>
<p><br />
</p>
<h3><a class="anchor" id="macros_compile_time_fast"></a>
Fast Compilation time</h3>
<ul>
<li>this is turned on by default on debug mode</li>
<li>this is turned off by default on release mode</li>
<li>to force it, define HPX_LOG_COMPILE_FAST_ON directive</li>
<li>applies only to logs that are declared/defined using HPX_DECLARE_LOG and HPX_DEFINE_LOG macros<ul>
<li>this is <em>transparent</em> to you, the programmer</li>
</ul>
</li>
<li>to see what headers you should include, click here</li>
</ul>
<p><br />
</p>
<h3><a class="anchor" id="macros_compile_time_slow"></a>
Slow Compilation time</h3>
<ul>
<li>this is turned off by default on debug mode</li>
<li>this is turned on by default on release mode</li>
<li>to force it, define HPX_LOG_COMPILE_FAST_OFF directive</li>
<li>applies only to logs that are declared/defined using HPX_DECLARE_LOG and HPX_DEFINE_LOG macros<ul>
<li>this is <em>transparent</em> to you, the programmer</li>
</ul>
</li>
<li>to see what headers you should include, click here</li>
</ul>
<p><br />
</p>
<h3><a class="anchor" id="HPX_LOG_compile_results"></a>
Compile time sample (and results)</h3>
<p>Recently I created a sample (compile_time) to test the effect of <code>HPX_LOG_COMPILE_FAST_ON</code>. The results were not as promising as I had hoped. However, still, when <code>HPX_LOG_COMPILE_FAST_ON</code> is on, will compile faster by 30-40%. Noting that this is just an simple example, the results might not be that conclusive. Anyway, here they are:</p>
<p>Tested on 16 jan 2008/intel core duo 2.16Ghz machine, 5400Rpm HDD</p>
<ul>
<li>VC 8.0 (no precompiled header)<ul>
<li>Debug<ul>
<li>Compile with HPX_LOG_COMPILE_FAST_ON (default) - 33 secs</li>
<li>Compile with HPX_LOG_COMPILE_FAST_OFF - 43 secs</li>
</ul>
</li>
</ul>
</li>
<li>gcc 3.4.2<ul>
<li>Debug<ul>
<li>Compile with HPX_LOG_COMPILE_FAST_ON (default) - 24 secs</li>
<li>Compile with HPX_LOG_COMPILE_FAST_OFF - 31 secs</li>
</ul>
</li>
</ul>
</li>
<li>gcc 4.1<ul>
<li>Debug<ul>
<li>Compile with HPX_LOG_COMPILE_FAST_ON (default) - 20.5 secs</li>
<li>Compile with HPX_LOG_COMPILE_FAST_OFF - 24 secs</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>If you have other results, or results from a big program using Boost Logging, please share them with me. Thanks!</p>
<p><br />
<br />
 </p>
<h2><a class="anchor" id="macros_tss"></a>
Macros that deal with Thread Specific Storage</h2>
<p>These are the macros that specify what implementation of TSS (Thread Specific <a class="el" href="../../db/dd5/namespace_storage.html">Storage</a>) we will be using. Note that I did my best to remove the dependency on <a class="el" href="../../d4/db4/namespacehpx_1_1compat.html#aa03f505e8c2bf9f96e834970850a4607">compat::thread</a></p><ul>
<li>the only dependence left is when you use use a logger that writes everything <a class="el" href="../../d9/de5/structhpx_1_1util_1_1logging_1_1writer_1_1on__dedicated__thread.html">on a dedicated thread</a>.</li>
</ul>
<p>By default, for TSS, we use the internal implementation (no dependency).</p>
<p>The possibilities are:</p><ul>
<li><a class="el" href="../../d9/d11/macros.html#HPX_LOG_TSS_USE_INTERNAL">HPX_LOG_TSS_USE_INTERNAL</a> : use our internal implementation (no dependency on <a class="el" href="../../d4/db4/namespacehpx_1_1compat.html#aa03f505e8c2bf9f96e834970850a4607">compat::thread</a>)</li>
<li><a class="el" href="../../d9/d11/macros.html#HPX_LOG_TSS_USE_BOOST">HPX_LOG_TSS_USE_BOOST</a> : use the implementation from <a class="el" href="../../d4/db4/namespacehpx_1_1compat.html#aa03f505e8c2bf9f96e834970850a4607">compat::thread</a> (dependency on <a class="el" href="../../d4/db4/namespacehpx_1_1compat.html#aa03f505e8c2bf9f96e834970850a4607">compat::thread</a>, of course).</li>
<li><a class="el" href="../../d9/d11/macros.html#HPX_LOG_TSS_USE_CUSTOM">HPX_LOG_TSS_USE_CUSTOM</a> : uses a custom implementation. The interface of this implementation should match <a class="el" href="../../d4/db4/namespacehpx_1_1compat.html#aa03f505e8c2bf9f96e834970850a4607">compat::thread</a>'s interface of <code><a class="el" href="../../da/dbf/classhpx_1_1util_1_1logging_1_1thread__specific__ptr.html">thread_specific_ptr</a></code> class</li>
<li><a class="el" href="../../d9/d11/macros.html#HPX_HAVE_LOG_NO_TSS">HPX_HAVE_LOG_NO_TSS</a> : don't use TSS</li>
</ul>
<h3><a class="anchor" id="HPX_LOG_TSS_USE_INTERNAL"></a>
HPX_LOG_TSS_USE_INTERNAL</h3>
<p>If defined, it uses our internal implementation for <a class="el" href="../../d9/d11/macros.html#macros_tss">TSS</a></p>
<h3><a class="anchor" id="HPX_LOG_TSS_USE_BOOST"></a>
HPX_LOG_TSS_USE_BOOST</h3>
<p>If defined, it uses the <a class="el" href="../../d4/db4/namespacehpx_1_1compat.html#aa03f505e8c2bf9f96e834970850a4607">compat::thread</a>'s implementation for <a class="el" href="../../d9/d11/macros.html#macros_tss">TSS</a></p>
<h3><a class="anchor" id="HPX_LOG_TSS_USE_CUSTOM"></a>
HPX_LOG_TSS_USE_CUSTOM</h3>
<p>If defined, it uses a custom implementation for <a class="el" href="../../d9/d11/macros.html#macros_tss">TSS</a>. The interface of this implementation should match <a class="el" href="../../d4/db4/namespacehpx_1_1compat.html#aa03f505e8c2bf9f96e834970850a4607">compat::thread</a>'s interface of <code><a class="el" href="../../da/dbf/classhpx_1_1util_1_1logging_1_1thread__specific__ptr.html">thread_specific_ptr</a></code> class.</p>
<p>Your class should have this interface: </p><div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">class </span>my_thread_specific_ptr ;</div></div><!-- fragment --><p>When #defining HPX_LOG_TSS_USE_CUSTOM, do it like this:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define HPX_LOG_TSS_USE_CUSTOM = my_thread_specific_ptr</span></div></div><!-- fragment --><h3><a class="anchor" id="HPX_HAVE_LOG_NO_TSS"></a>
HPX_HAVE_LOG_NO_TSS</h3>
<p>If defined, we don't use <a class="el" href="../../d9/d11/macros.html#macros_tss">TSS</a> as all. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Sep 18 2017 12:02:13 for HPX by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
